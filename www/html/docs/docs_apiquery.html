<html>
	<head>
		<link href="/rightsdraw2/css/docs.css" type="text/css" rel="stylesheet"/>
	</head>
	<body>
		<h2>Query Context interfaces</h2>
		<p>
The query context, with prefix <i>/cgi-bin/rightsdraw2/&lt;user&gt;/query</i>, provides the following Interfaces:
		</p>
<hr/>
<a href="#checkwith">checkwith</a>
<a href="#dosearch">dosearch</a>
<a href="#guiadm">guiadm</a>
<a href="#getbasicmets2create">p4/getbasicmets2create</a>
<a href="#getlist">p4/getlist</a>
<a href="#getvideoplayer">p4/getvideoplayer</a>
<a href="#showbasicmets">p4/showbasicmets</a>
<a href="#rebuildindex">rebuildindex</a>
<a href="#showform">showform</a>


<hr/>
		<a name="checkwith">
		<h4>Name: checkwith</h4>
		<p>
		<b>Description</b>
Creates a query, in terms of a target exploitation, according to the given parameters and compare it with the indexed Permissions found in the MCO documents of the User repository, returning the list of MCO documents having Permissions matching the target exploitation. The Permission doesn't need to be exactly the same, but must be compatible with target one, i.e. it must either the same or wider (having less conditions, or conditions with wider boundaries, or more general permitted actions). 
<br/>Alternatively the query is posted to the <i>P4/wf/query_rights</i> interface, and the service presents the results to the User for further actions.
		</p>
		<p>
		<b>Method:</b> GET
		</p>
		<p>
		<b>Parameters:</b>
		</p>
		<ul>
			<li><b>querymode</b> - one between 'local' and 'p4'. It sets if the query is performed on the local repository or on the remote P4 service, which must be enabled. It defaults to the value which was set the last time by the User with <a href="#guiadm">guiadm</a>.
			<li><b>output</b> - optional, default='html', which includes a number of buttons for further actions on matching MCO documents; otherwise the output is just the list of matching MCO documents in the user repository area. Use is limited to querymode='local'.
			<li><b>owner</b> - IRI of who(User or Organization) acts the permitted action(s)
			<li><b>IPEntity</b> - IRI of the Object of the Permission
			<li><b>relid</b> - Identifier of the Object of the Permission
			<li><b>kp</b> - name of a Key Pattern, which can be used as template for the query instead of specifying a <i>permitted action</i> and most Facts. Still Facts specifying the contexts have normally to be specified
			<li><b>permittedaction</b> - IRI of a SubClassOf mvco:Action, which is going to be permitted by the defined Permission
			<li>DataProperties of the Permission
			<li><b>isexclusive</b> - boolean value of mco-ipre:isExlclusive  (default: false) 
			<li><b>hassublicense</b> - boolean value of mco-ipre:hasSublicenseRight  (default: true) 
			<li>Classes of Facts
			<li><b>accesspolicy</b> - IRI of a SubClassOf mco-ipre:AccessPolicy
			<li><b>deliverymodality</b> - IRI of a SubClassOf mco-ipre:DeliveryModality
			<li><b>device</b> - IRI of a SubClassOf mco-ipre:Device
			<li><b>means</b> - IRI of a SubClassOf mco-ipre:Means
			<li><b>relatedaction</b> - IRI of a SubClassOf mco-core:ActionRelatedFact
			<li><b>serviceaccesspolicy</b> - IRI of a SubClassOf mco-ipre:ServiceAccessPolicy
			<li><b>usertimeaccess</b> - IRI of a SubClassOf mco-ipre:UserTimeAccess
			<li>Flags for setting Facts to Negative
			<li><b>negativeaccesspolicy</b> 
			<li><b>negativedeliverymodality</b>
			<li><b>negativedevice</b>
			<li><b>negativelanguages</b>
			<li><b>negativemeans</b>
			<li><b>negativerelatedaction</b>
			<li><b>negativeserviceaccesspolicy</b>
			<li><b>negativespatialcontext</b>
			<li><b>negativetemporalcontext</b>
			<li><b>negativeusertimeaccess</b>
			<li>DataProperties implying related Facts
			<li><b>afterdate</b> - value of mco-ipre:afterDate for a mco-ipre:TemporalContext - format: YYYYMMDD
			<li><b>beforedate</b> - value of mco-ipre:beforeDate for a mco-ipre:TemporalContext - format: YYYYMMDD
			<li><b>languages</b> - value of mco-ipre:hasLanguage for a mco-ipre:Language - format: list of ISO 639-1 language codes (each as '#&lt;code&gt;;') 
			<li><b>numruns</b> - value of mco-ipre:hasNumberOfRuns for a mco-ipre:Run - format: positiveInteger
			<li><b>runduration</b> - value of mco-ipre:hasValidity for a mco-ipre:Run - ISO 8601 Duration
			<li><b>numreps</b> - value of mco-ipre:hasNumberOfRepetitions for a mco-ipre:Run - format: positiveInteger 
			<li><b>territories</b> - value of mco-ipre:hasCountry for a mco-ipre:SpatialContext - format: list of ISO 3166 country codes (each as '#&lt;CODE&gt;;') 
		</ul>
		<p> <b>Returned content-type:</b> text/html </p>
		<p>
		<b>See also:</b> <a href="docs_apimco.html#definepermission">mco/definepermission</a>
		</p>
<!-- //////////////////////////////////////////////////////////////-->
<hr/>
		<a name="dosearch">
		<h4>Name: dosearch</h4>
		<p>
		<b>Description</b>
Search for contract documents in the User repository containing MCO elements matching the given search criteria for MCO Individuals (member of MCO classes). All the inputs are optional and are all considered in AND.
		</p>
		<p>
		<b>Method:</b> GET
		</p>
		<p>
		<b>Parameters:</b>
		</p>
		<ul>
			<li><b>output</b> - optional, default='html', which includes a number of buttons for further actions on matching MCO documents; otherwise the output is just the list of matching MCO documents in the user repository area
			<li><b>class</b> - IRI of the Class
			<li><b>ind</b> - IRI of the Individual
			<li><b>md</b> - value of Annotation metadata
			<li><b>mdexact</b> - boolean (default='false') for requesting exact match, instead of "contains" for searching Annotation metadata
			<li><b>key</b> - IRI of DataProperty
			<li><b>value</b> - value of DataProperty
			<li><b>valueexact</b> - boolean (default='false') for requesting exact match, instead of "contains" for searching value of DataProperties 
			<li><b>obj</b> - IRI of Object Property
			<li><b>objtype</b> - switch between 'range' (default) and 'domain' for searching individuals having the given ObjectProperty
			<li><b>negative</b> - boolean (default='false') for switching the search to NegativeObjectProperties
		</ul>
		<p> <b>Returned content-type:</b> text/html </p>
<!-- //////////////////////////////////////////////////////////////-->
<hr/>
		<a name="guiadm">
		<h4>Name: guiadm</h4>
		<p>
		<b>Description</b>
Serves to the User, as html output, a number of forms for creating and submitting queries to P4 (getlist, checkwith). 
		</p>
		<p>
		<b>Method:</b> GET
		</p>
		<p>
		<b>Parameters:</b>
		<ul>
			<li><b>querymode</b> - one between 'local' and 'p4'. It sets if the query is performed on the local repository or on the remote P4 service, which must be enabled. It defaults to the value which was set the last time by the User.
		</ul>
		</p>
		<p> <b>Returned content-type:</b> text/html </p>
		<p>
		<b>See also:</b> <a href="#checkwith">checkwith</a>, <a href="#getlist">p4/getlist</a>, <a href="#showform">showform</a>
		</p>
<!-- //////////////////////////////////////////////////////////////-->
<hr/>
		<a name="getbasicmets2create">
		<h4>Name: p4/getbasicmets2create</h4>
		<p>
		<b>Description</b>
Given the identifier of a P4 AIP, which is assumed to lack of rights information, it retrieves from <i>P4</i> the corresponding DIP, from which it extracts the basic Dublin Core information (identifier, title, and description) and uses them for re-directing the request to a <i>create</i> service in <i class="rd">RightsDraw</i>.
		</p>
		<p>
		<b>Method:</b> GET
		</p>
		<p>
		<b>Parameters:</b>
		</p>
		<ul>
			<li><b>identifier</b> - ID of a P4 AIP
		</ul>
		<p> <b>Returned content-type:</b> text/html </p>

<!-- //////////////////////////////////////////////////////////////-->
<hr/>
		<a name="getlist">
		<h4>Name: p4/getlist</h4>
		<p>
		<b>Description</b>
Gets from P4 the list of archival items which already have (<i>available=true</i>) or not have yet (<i>available=false</i>) rights information included in the AIP. 
The resulting list is served as html output with a number of forms, for each item, permitting to the User a selection among various working options.
		</p>
		<p>
		<b>Method:</b> GET
		</p>
		<p>
		<b>Parameters:</b>
		</p>
		<ul>
			<li><b>available</b> - true or false 
		</ul>
		<p> <b>Returned content-type:</b> text/html </p>

<!-- //////////////////////////////////////////////////////////////-->
<hr/>
		<a name="getvideoplayer">
		<h4>Name: p4/getvideoplayer</h4>
		<p>
		<b>Description</b>
Gets from P4 a videoplayer for the content browsing quality of the given archival item
		</p>
		<p>
		<b>Method:</b> GET
		</p>
		<p>
		<b>Parameters:</b>
		</p>
		<ul>
			<li><b>dipid</b> - ID of P4 DIP
		</ul>
		<p> <b>Returned content-type:</b> text/html </p>
<!-- //////////////////////////////////////////////////////////////-->
<hr/>
		<a name="showbasicmets">
		<h4>Name: p4/showbasicmets</h4>
		<p>
		<b>Description</b>
Given the identifier of a P4 AIP, it retrieves from <i>P4</i> the corresponding DIP and serves to the User, as html output, the basic Dublic Core information.
		</p>
		<p>
		<b>Method:</b> GET
		</p>
		<p>
		<b>Parameters:</b>
		</p>
		<ul>
			<li><b>identifier</b> - ID of a P4 AIP
		</ul>
		<p> <b>Returned content-type:</b> text/html </p>
<!-- //////////////////////////////////////////////////////////////-->
<hr/>
		<a name="rebuildindex">
		<h4>Name: rebuildindex</h4>
		<p>
		<b>Description</b>
Creates or rebuild the index of MCO documents of the user's repository or asks P4 for rebuilding the index of MCO documents stored on P4 service.
		</p>
		<p>
		<b>Method:</b> GET
		</p>
		<p> <b>Parameters:</b> </p>
		<ul>
			<li><b>querymode</b> - one between 'local' and 'p4'. It sets if the index to be created/rebuilt is that of the local repository or on the remote P4 service, which must be enabled. It defaults to the value which was set the last time by the User with <a href="#guiadm">guiadm</a>.
		<ul>
		<p> <b>Returned content-type:</b> text/plain </p>
<!-- //////////////////////////////////////////////////////////////-->
<hr/>
		<a name="showform">
		<h4>Name: showform</h4>
		<p>
		<b>Description</b>
Serves the requested form to the User as html output, for creating and posting queries
		</p>
		<p>
		<b>Method:</b> GET
		</p>
		<p>
		<b>Parameters:</b>
		</p>
		<ul>
			<li><b>form</b> - name of a form among:
			<ul>
				<li>query-finditems-form.html
				<li>query-free-form.html
				<li>query-kpr-form.html
			</ul>
		</ul>
		<p>
		<b>See also:</b> <a href="#checkwith">checkwith</a>, <a href="#getlist">p4/getlist</a>, <a href="#guiadm">guiadm</a>
		</p>
<hr/>
	</body>
</html>
